import{U as m,J as l,O as r,C as v,h as w}from"./index-294842fb.js";import{D as y,O as g,M as u,A as E,T as f}from"./floating-ui.dom.esm-e435ab9f-9ae38738.js";import{n as b}from"./align-0c96facf-05ccab87.js";import{a as k}from"./show-9951ecef-501b6155.js";import"./alignment-84fc6207-42b58888.js";import"./prop.validators-125a3282-9e7c3ce9.js";import"./a11y.tipps-583a2096-ea796d66.js";/*!
 * KoliBri - The accessible HTML-Standard
 */const x=":host{--a11y-min-size:44px;font-size:inherit}*{font-family:Verdana;hyphens:auto;letter-spacing:inherit;word-break:break-word;word-spacing:inherit}[role='button'],button:not([role='link']),kol-input .input{min-height:var(--a11y-min-size);min-width:var(--a11y-min-size)}a,button,h1,h2,h3,h4,h5,h6,input,option,select,textarea{font-family:inherit;font-size:inherit}:is(a,button){background-color:transparent;border:none;margin:0;padding:0;width:100%;}:host{max-width:100%}*{box-sizing:border-box}kol-span-wc{display:grid;place-items:center}kol-span-wc>span{display:flex;place-items:center}a,button{cursor:pointer}button,input,option,select,textarea{font-family:inherit}.icon-only>kol-span-wc>span>span{display:none}kol-popover{height:0;position:absolute}kol-popover .popover{background-color:#fff;min-height:max-content;min-width:max-content;opacity:0;position:absolute}kol-popover .hidden{display:none}kol-popover .show{animation:0.3s ease-in forwards fadeInOpacity}kol-popover .disappear{animation:0.3s ease-in backwards fadeInOpacity}kol-popover .arrow{background-color:inherit;height:var(--font-size);position:absolute;rotate:0.125turn;width:var(--font-size);z-index:-1}@keyframes fadeInOpacity{0%{opacity:0}100%{opacity:1}}",P=class{constructor(e){m(this,e),this.alignPopover=t=>{setTimeout(()=>{var i;if(w!=="test"&&this.triggerElement&&this.popoverElement){const n=this.triggerElement,s=this.popoverElement,o=this.arrowElement,a=[y((i=o==null?void 0:o.offsetHeight)!==null&&i!==void 0?i:10),g(),u()];o&&a.push(f({element:o})),E(n,s,{placement:this.state._align,middleware:a}).then(({x:h,y:p,middlewareData:c,placement:d})=>{this.setPosition(h,p,c,d,t)})}})},this.showPopover=()=>{this.addListenersToBody(),this.alignPopover(()=>{this.state=Object.assign(Object.assign({},this.state),{_visible:!0})})},this.hidePopoverByEscape=t=>{t.key==="Escape"&&this.hidePopover()},this.hidePopoverByClickOutside=t=>{this.host&&!this.host.contains(t.target)&&this.hidePopover()},this.catchHostAndTriggerElement=t=>{t&&(this.host=t,this.triggerElement=t.previousElementSibling)},this.catchPopoverElement=t=>{this.popoverElement=t},this.catchArrowElement=t=>{this.arrowElement=t},this._align="top",this._show=!1,this.state={_align:"top",_show:!1,_visible:!1}}setPosition(e,t,i,n,s){if(this.popoverElement){const o={left:this.popoverElement.style.left,top:this.popoverElement.style.top};if(Object.assign(this.popoverElement.style,{left:`${e}px`,top:`${t}px`}),this.arrowElement&&i.arrow)switch(n){case"top":this.arrowElement.style.inset=`100% auto auto ${i.arrow.x||0}px`,this.arrowElement.style.translate="0 -50%";break;case"right":this.arrowElement.style.inset=`${i.arrow.y||0}px 100% auto auto`,this.arrowElement.style.translate="50% 0";break;case"bottom":this.arrowElement.style.inset=`auto auto 100% ${i.arrow.x||0}px`,this.arrowElement.style.translate="0 50%";break;case"left":this.arrowElement.style.inset=`${i.arrow.y||0}px auto auto 100%`,this.arrowElement.style.translate="-50% 0"}o.left!==this.popoverElement.style.left||o.top!==this.popoverElement.style.top?this.alignPopover(s):typeof s=="function"&&s()}}hidePopover(){var e;this.state=Object.assign(Object.assign({},this.state),{_visible:!1}),this._show=!1,(e=this.triggerElement)===null||e===void 0||e.focus(),this.removeListenersToBody()}addListenersToBody(){var e;const t=l().body;t.addEventListener("keyup",this.hidePopoverByEscape),t.addEventListener("click",this.hidePopoverByClickOutside),(e=document.scrollingElement)===null||e===void 0||e.addEventListener("scroll",this.showPopover,{passive:!0})}removeListenersToBody(){var e;const t=l().body;t.removeEventListener("keyup",this.hidePopoverByEscape),t.removeEventListener("click",this.hidePopoverByClickOutside),(e=document.scrollingElement)===null||e===void 0||e.removeEventListener("scroll",this.showPopover)}render(){return r(v,{ref:this.catchHostAndTriggerElement},r("div",{class:{popover:!0,hidden:!this.state._show,show:this.state._visible},ref:this.catchPopoverElement},r("div",{class:`arrow ${this.state._align}`,ref:this.catchArrowElement}),r("slot",null)))}validateAlign(e){b(this,e)}validateShow(e){k(this,e),e&&this.showPopover()}componentWillLoad(){this.validateAlign(this._align),this.validateShow(this._show)}static get watchers(){return{_align:["validateAlign"],_show:["validateShow"]}}};P.style=x;export{P as kol_popover};
